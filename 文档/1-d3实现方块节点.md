d3显示方块节点

### 1，后端写接口

1. 数据的json文件

2. 写controller 和 router

   先使用简单的数据保证可以get到

```js
const Controller = require('egg').Controller;

class TreeController extends Controller {
    async getTreeData() {
        const { ctx } = this
        ctx.body = 'Hello getTreeData -----';
    }
}
module.exports = TreeController;
```

这个时候只使用了controller的数据，但是service写错了，执行的时候还是报错

—— 这个egg框架的执行是所有的代码都测试一次么？

接口成功

3. 写service

   官方说明，service产生controller需要的数据

```js
// service
const Service = require('egg').Service;

const path = require('path')
const fs = require('fs')
class TreeDataService extends Service {
    treeData() {
        let file = path.join(__dirname, '../data/treeData.json')
        let data =  fs.readFileSync(file)
        let res = data.toString();
        const treeList = JSON.parse(res);
        return treeList
    }
}
module.exports = TreeDataService;
```

```js
// controller
const Controller = require('egg').Controller;

class TreeController extends Controller {
    async getTreeData() {
        const { ctx } = this
        // ctx.body = 'Hello getTreeData -----';
        const treeData = await ctx.service.treeDataSer.treeData()
        console.log('treeData', treeData)
        ctx.status = 200
        ctx.body = {
            data: treeData
        }
    }
}
module.exports = TreeController;
```



